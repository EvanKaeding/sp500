{
    "collab_server" : "",
    "contents" : "## SP500 List maker\n\n## This script reads data from a table on Wikipedia containing information about the\n## top 500 companies by revenue in the world, cleans it and outputs it into a data.frame.\n\n## NOTE: This version is depricated. Please use get_sp500.R instead.\n\n## Libraries\n\nlibrary(httr)\nlibrary(XML)\n\n## Download the page and parse it\n\nurl <- \"https://en.wikipedia.org/wiki/List_of_S%26P_500_companies\"\n\nhtml <- GET(url)\n\ncontents <- content(html, as = \"text\")\nparsedHTML <- htmlParse(contents, asText = TRUE)\n\n## Start grabbing stuff\n\nheaders <- xpathSApply(parsedHTML, \"//th\", xmlValue)\nbody <- xpathSApply(parsedHTML, \"//td\", xmlValue)\n\n## Clean it up\n\n# clean up headers by truncating it, making lower case and adding subbing in underscores for spaces\n\nheaders <- headers[c(1:8)]\nheaders <- tolower(headers)\nheaders <- gsub(\" \", \"_\", headers)\n\n# body: One would expect body to contain 500 * 8 = 4,000 values. However, it contains 4,995\n# Upon further analysis, it appears that body grabbed table rows for all tables, not just the\n# SP500 table. The final character in this table is 0001555280, which has an index of 4,040\n# indicating that there are 505 observations of 8 variables. This info will be used to inform\n# the design of the cleaning script. Future iterations of this script should extract only the\n# relevant information from the webpage.\n\nbody <- body[c(1:4040)]\n\n# create the data.frame\n\ndata <- data.frame(matrix(data = body, nrow = 505, ncol = 8, byrow = TRUE))\ncolnames(data) <- headers\n\n# correct the variable types\n\ndata$ticker_symbol <- as.character(data$ticker_symbol)\ndata$security <- as.character(data$security)\ndata <- data[,c(1,2,4:8)] #remove the 'sec_filing' variable\ndata$address_of_headquarters <- as.character(data$address_of_headquarters)\ndata$date_first_added <- ymd(as.character(data$date_first_added)) #coerces blanks to NAs\ndata$cik <- as.character(data$cik)\n\n## Give it a nice name and write it out to preserve the structure\n\nSP500 <- data\nsave(SP500, file = \"SP500.rda\")\n\n# to load SP500 as a DF into your global environment, do this:\n# load(\"path/SP500.rda\")\n",
    "created" : 1513819362301.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4263884870",
    "id" : "7F6129B4",
    "lastKnownWriteTime" : 1513819449,
    "last_content_update" : 1513819449535,
    "path" : "~/Projects/sp500/sp500_list_getter.R",
    "project_path" : "sp500_list_getter.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}